<?xml version="1.0" encoding="UTF-8"?><SQLQuery AllowBuffering="false" AllowFuture="true" AutoTypeParameters="false" CacheDuration="0" CacheDurationUnits="M" Columns="" Comment="" Connector="" DateColumn="" DateFormat="MM/dd/yyyy HH:mm:ss" Debug="false" Description="" DocType="SQLQuery" Duration="60" DurationUnits="M" EndDate="" FilterExpr="" FixedQuery="" Group="" GroupingExpr="" ID="263592" InlineTransform="" IntervalCount="1" IsCachable="false" JoinExpr="" Mask="" Method="" Mode="FixedQuery" NumberFormat="0.00" Param.1="20240417" Param.10="" Param.11="" Param.12="" Param.13="" Param.14="" Param.15="" Param.16="" Param.17="" Param.18="" Param.19="" Param.2="20240417" Param.20="" Param.21="" Param.22="" Param.23="" Param.24="" Param.25="" Param.26="" Param.27="" Param.28="" Param.29="" Param.3="" Param.30="" Param.31="" Param.32="" Param.4="" Param.5="" Param.6="" Param.7="" Param.8="" Param.9="" ParamDescription.1="" ParamDescription.10="" ParamDescription.11="" ParamDescription.12="" ParamDescription.13="" ParamDescription.14="" ParamDescription.15="" ParamDescription.16="" ParamDescription.17="" ParamDescription.18="" ParamDescription.19="" ParamDescription.2="" ParamDescription.20="" ParamDescription.21="" ParamDescription.22="" ParamDescription.23="" ParamDescription.24="" ParamDescription.25="" ParamDescription.26="" ParamDescription.27="" ParamDescription.28="" ParamDescription.29="" ParamDescription.3="" ParamDescription.30="" ParamDescription.31="" ParamDescription.32="" ParamDescription.4="" ParamDescription.5="" ParamDescription.6="" ParamDescription.7="" ParamDescription.8="" ParamDescription.9="" ParamType.1="" ParamType.10="" ParamType.11="" ParamType.12="" ParamType.13="" ParamType.14="" ParamType.15="" ParamType.16="" ParamType.17="" ParamType.18="" ParamType.19="" ParamType.2="" ParamType.20="" ParamType.21="" ParamType.22="" ParamType.23="" ParamType.24="" ParamType.25="" ParamType.26="" ParamType.27="" ParamType.28="" ParamType.29="" ParamType.3="" ParamType.30="" ParamType.31="" ParamType.32="" ParamType.4="" ParamType.5="" ParamType.6="" ParamType.7="" ParamType.8="" ParamType.9="" Password="" PathID="1165" Query="--SLC_OPR_DURATION_PERS_DETAIL_QRY NEW&#10;&#10;set NOCOUNT on&#10;&#9;        -- sap pdks data&#10;select&#10;&#9;&#9;&#9;&#9;   cast(PERNR as int) PERNR,&#10;&#9;&#9;&#9;&#9;   KOSTL KOSTL,&#10;&#9;&#9;&#9;       ENAME ENAME,&#10;&#9;&#9;&#9;       SUM(ZNCSZ) ZNCSZ,&#10;&#9;&#9;&#9;       SUM(ZNCGZ) ZNCGZ,&#10;&#9;&#9;&#9;       WERKS WERKS,&#10;&#9;&#9;&#9;       BTRTL BTRTL,&#10;&#9;&#9;&#9;       PERSG PERSG,&#10;&#9;&#9;&#9;       PERSK PERSK,&#10;&#9;&#9;&#9;       ORGEH ORGEH,&#10;&#9;&#9;&#9;       PLANS PLANS,&#10;&#9;&#9;&#9;       SUM(ZF150) ZF150,&#10;&#9;&#9;&#9;       SUM(ZF200) ZF200,&#10;&#9;&#9;&#9;       Z_START_DATE,&#10;      &#9;&#9;&#9;   Z_END_DATE,&#10;      &#9;&#9;&#9;   DATUM DATUM,&#10;      &#9;&#9;&#9;   BEGUZ BEGUZ,&#10;       &#9;&#9;&#9;   ENDUZ ENDUZ&#10; into #TempTable1&#9;&#9;&#9;       &#10;from EST.dbo.[HIST_PERSONAL_PDKS] hpp&#10;WHERE&#10;&#9;&#9;(DATUM BETWEEN '[Param.1] 00:00:00' AND '[Param.2] 00:00:00'&#10;&#9;&#9;or DATUM BETWEEN '[Param.1] 00:00:00' AND '[Param.2] 00:00:00'&#10;&#9;&#9;or DATUM &lt; '[Param.1] 00:00:00'&#10;&#9;&#9;AND DATUM &gt; '[Param.2] 00:00:00'&#10;&#9;&#9;&#9;&#9;&#9; )&#10;&#9;&#9;[Param.3]&#10;GROUP BY PERNR, ENAME, WERKS, BTRTL, PERSG, PERSK, ORGEH, PLANS, KOSTL,DATUM,BEGUZ,ENDUZ,Z_START_DATE,Z_END_DATE&#10;&#9;&#9;&#9;&#9;&#9;&#10;&#10;ORDER BY PERNR&#10;&#10;--SELECT * FROM  #TempTable1&#10;&#10;SELECT OPER_ID, CONF_TIME, SNAME, &#10;SUM(OFFTIME) OFFTIME, &#10;SUM(PREPTIME) PREPTIME, &#10;SUM(UPTIME) UPTIME, &#10;SUM(PLANNED_DOWN) PLANNED_DOWN, &#10;SUM(UNPLANNED_DOWN) UNPLANNED_DOWN, &#10;SUM(LOGON_DURATION) LOGON_DURATION, &#10;SUM(MACHINE_CNT_CYCLE) MACHINE_CNT_CYCLE, &#10;SUM(NON_LOGON_DURATION) NON_LOGON_DURATION, &#10;SUM(NON_PRODUCTION_DURATION) NON_PRODUCTION_DURATION&#10;into #TempTable2&#10;FROM EST.dbo.HIST_PRODUCTIVITY_OPERATION&#10;WHERE (CONF_TIME BETWEEN '[Param.1] 00:00:00' AND '[Param.2] 23:59:59')&#9;&#10;GROUP BY  OPER_ID, CONF_TIME, SNAME&#10;&#10;--SELECT * FROM  #TempTable2&#10;&#10;&#10;--SELECT * FROM #TempTable1 t1&#10;--LEFT JOIN  #TempTable2  t2&#10;--ON t1.PERNR=t2.OPER_ID&#10;&#10;&#10;SELECT PERNR,ENAME,WERKS , BTRTL,PERSG,PERSK,ORGEH,PLANS,KOSTL,DATUM,BEGUZ,ENDUZ,&#10;ZNCSZ,ZNCGZ,ZF150,ZF200,Z_START_DATE, Z_END_DATE ,OPER_ID ,CONF_TIME,SNAME,OFFTIME,PREPTIME,&#10;UPTIME,PLANNED_DOWN,UNPLANNED_DOWN,LOGON_DURATION ,MACHINE_CNT_CYCLE,&#10;str_replace(CONVERT( CHAR( 19 ), Z_START_DATE, 23 ),'T',' ') GIRIS_ZAMANI,&#10;str_replace(CONVERT( CHAR( 19 ), Z_END_DATE, 23 ),'T',' ') CIKIS_ZAMANI,&#10;(ZF150+ZF200)*60 FM,&#10;(ZNCSZ+ZF150+ZF200)*60 FIILISURE,&#10;(((ZNCSZ+ZF150+ZF200)*60) - LOGON_DURATION) CALISILMAYANSURE1,&#10;CASE WHEN (((ZNCSZ+ZF150+ZF200)*60) - LOGON_DURATION)&lt;0 THEN 0 ELSE (((ZNCSZ+ZF150+ZF200)*60) - LOGON_DURATION) END CALISILMAYANSURE,&#10;(((ZNCSZ+ZF150+ZF200)*60) - LOGON_DURATION)+(UNPLANNED_DOWN+PREPTIME) URETIMOLMAYANSURE,&#10;case WHEN (ZNCSZ+ZF150+ZF200) = 0 THEN 0 ELSE convert(int,((convert(decimal,MACHINE_CNT_CYCLE)/ convert(decimal,((ZNCSZ+ZF150+ZF200)*60))))*100) END PRODUCTIVITY,&#10;case WHEN (LOGON_DURATION+  convert(decimal,(UNPLANNED_DOWN+PREPTIME)))=0 &#10;THEN 0&#10;ELSE&#10;convert(int,(convert(decimal,MACHINE_CNT_CYCLE)/&#10;(convert(decimal,((ZNCSZ+ZF150+ZF200)*60))- --fiili süre&#10;((convert(decimal,((ZNCSZ+ZF150+ZF200)*60))-LOGON_DURATION)+--çalışılmayan süre&#10;convert(decimal,(UNPLANNED_DOWN+PREPTIME)))))*100) END EFFICIENCY&#10;&#9;FROM #TempTable1 t1&#10;&#9;LEFT JOIN  #TempTable2  t2&#10;&#9;ON t1.PERNR=t2.OPER_ID&#10;&#9;and t2.CONF_TIME between dateadd(hh,-1,Z_START_DATE) and dateadd(hh,1,Z_END_DATE)&#10;    GROUP BY PERNR,ENAME,WERKS,BTRTL,PERSG,PERSK,ORGEH,PLANS,KOSTL,DATUM,BEGUZ,ENDUZ,ZNCSZ,ZNCGZ,ZF150,ZF200,Z_START_DATE, Z_END_DATE,&#10;OPER_ID,CONF_TIME,SNAME,OFFTIME,PREPTIME,UPTIME,PLANNED_DOWN,UNPLANNED_DOWN,LOGON_DURATION,MACHINE_CNT_CYCLE,Z_START_DATE,Z_END_DATE&#10;ORDER BY PERNR&#10;       &#10;&#10;drop table  #TempTable1&#10;drop table  #TempTable2" QueryParams="" ReaderRoles="SAP_XMII_User" RestrictedPropertyOverride="false" RowCount="9999" SaveDate="07/31/2024 10:47:42" Schedule="" SelectedColumns="" Server="MII_DB" Service="" SortExpr="" StartDate="" Tables="" Time="" TimePeriod="" Trace="false" UseTypedParams="false" UserName="" Version="15.0.4.2" WriterRoles="SAP_XMII_Super_Administrator,SAP_XMII_Administrator,SAP_XMII_Developer" XParamName.1="" XParamName.10="" XParamName.11="" XParamName.12="" XParamName.13="" XParamName.14="" XParamName.15="" XParamName.16="" XParamName.2="" XParamName.3="" XParamName.4="" XParamName.5="" XParamName.6="" XParamName.7="" XParamName.8="" XParamName.9="" XParamValue.1="" XParamValue.10="" XParamValue.11="" XParamValue.12="" XParamValue.13="" XParamValue.14="" XParamValue.15="" XParamValue.16="" XParamValue.2="" XParamValue.3="" XParamValue.4="" XParamValue.5="" XParamValue.6="" XParamValue.7="" XParamValue.8="" XParamValue.9=""><Tasks/><ETCServers/><ETCObjects/></SQLQuery>